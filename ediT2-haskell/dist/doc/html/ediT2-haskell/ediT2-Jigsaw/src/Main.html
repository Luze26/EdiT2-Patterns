<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Jigsaw/Jigsaw.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Util</span><span class='hs-varop'>.</span><span class='hs-conid'>Util</span>
<a name="line-2"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Util</span><span class='hs-varop'>.</span><span class='hs-conid'>TreeGenerator</span>
<a name="line-3"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>System</span><span class='hs-varop'>.</span><span class='hs-conid'>Environment</span><span class='hs-layout'>(</span> <span class='hs-varid'>getArgs</span> <span class='hs-layout'>)</span>
<a name="line-4"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>JigsawModel</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<a name="line-5"></a>
<a name="line-6"></a>
<a name="line-7"></a>
<a name="line-8"></a><a name="main"></a><span class='hs-comment'>-- | 'main', entry point. Expect a file path in argument pointing to a file containing information needed.</span>
<a name="line-9"></a><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span><span class='hs-conid'>()</span>
<a name="line-10"></a><span class='hs-definition'>main</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-11"></a>	<span class='hs-varid'>args</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getArgs</span>
<a name="line-12"></a>	<span class='hs-varid'>text</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>readFile</span> <span class='hs-varop'>$</span> <span class='hs-varid'>head</span> <span class='hs-varid'>args</span> <span class='hs-comment'>-- Read the file past in argument</span>
<a name="line-13"></a>	<span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>file</span><span class='hs-layout'>,</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>readText</span> <span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>read</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- Extract information from the text. file = output file. info = information.</span>
<a name="line-14"></a>	<span class='hs-keyword'>let</span> <span class='hs-varid'>noPoss</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>notPossible</span> <span class='hs-varop'>$</span> <span class='hs-varid'>repartitionJigsaw</span> <span class='hs-layout'>(</span><span class='hs-varid'>participantsList</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>repartitionInitial</span> <span class='hs-varid'>info</span>
<a name="line-15"></a>	<span class='hs-keyword'>if</span> <span class='hs-varid'>noPoss</span> <span class='hs-varop'>==</span> <span class='hs-conid'>[]</span>
<a name="line-16"></a>		<span class='hs-keyword'>then</span> <span class='hs-keyword'>do</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>lvls</span><span class='hs-layout'>,</span> <span class='hs-varid'>patternObjects</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>generateLevels</span> <span class='hs-varid'>info</span> <span class='hs-comment'>-- lvls = list of levels, patternObjects = pattern objects.</span>
<a name="line-17"></a>			<span class='hs-varid'>writeT2</span> <span class='hs-varid'>file</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"Activity"</span><span class='hs-layout'>,</span><span class='hs-str'>"Resource"</span><span class='hs-layout'>,</span><span class='hs-str'>"Group"</span><span class='hs-layout'>,</span><span class='hs-str'>"Role"</span><span class='hs-layout'>,</span><span class='hs-str'>"Participant"</span><span class='hs-keyglyph'>]</span> <span class='hs-layout'>(</span><span class='hs-varid'>generate</span> <span class='hs-varid'>lvls</span><span class='hs-layout'>)</span> <span class='hs-varid'>patternObjects</span> <span class='hs-comment'>-- Write a fil</span>
<a name="line-18"></a>		<span class='hs-keyword'>else</span> <span class='hs-varid'>writeT2Err</span> <span class='hs-varid'>file</span> <span class='hs-varid'>noPoss</span>
<a name="line-19"></a>
<a name="line-20"></a>
<a name="line-21"></a>
<a name="line-22"></a><a name="notPossible"></a><span class='hs-comment'>-- | 'notPossible', return the list of not possible actions.</span>
<a name="line-23"></a><span class='hs-definition'>notPossible</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Possible</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Possible actions.</span>
<a name="line-24"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Possible</span> <span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Not possible actions.</span>
<a name="line-25"></a><span class='hs-definition'>notPossible</span> <span class='hs-varid'>actions</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>acc</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span> <span class='hs-conid'>NotPossible</span> <span class='hs-varid'>msg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NotPossible</span> <span class='hs-varid'>msg</span> <span class='hs-conop'>:</span> <span class='hs-varid'>acc</span><span class='hs-layout'>;</span> <span class='hs-conid'>Possible</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>acc</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>actions</span>
<a name="line-26"></a>
<a name="line-27"></a>
<a name="line-28"></a>
<a name="line-29"></a><a name="generateLevels"></a><span class='hs-comment'>-- | 'generateLevels', generatee the levels of the tree.</span>
<a name="line-30"></a><span class='hs-definition'>generateLevels</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-31"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Level</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>PatternObjects</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- ^ Levels and pattern objects generated.</span>
<a name="line-32"></a><span class='hs-definition'>generateLevels</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>lvls</span><span class='hs-layout'>,</span> <span class='hs-varid'>patternObjects'</span><span class='hs-layout'>)</span>
<a name="line-33"></a>	<span class='hs-keyword'>where</span>
<a name="line-34"></a>		<span class='hs-varid'>lvls</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>generateActivitiesLvl</span> <span class='hs-conop'>:</span> <span class='hs-varid'>generateGroupsLvl</span> <span class='hs-varid'>info</span> <span class='hs-conop'>:</span> <span class='hs-varid'>generateParticipantsLvl</span> <span class='hs-varid'>info</span> <span class='hs-conop'>:</span> <span class='hs-varid'>generateResourcesLvl</span> <span class='hs-varid'>info</span> <span class='hs-conop'>:</span> <span class='hs-conid'>[]</span>
<a name="line-35"></a>		<span class='hs-varid'>patternObjects'</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>actObj</span><span class='hs-layout'>,</span><span class='hs-varid'>groupObj</span><span class='hs-layout'>,</span><span class='hs-varid'>partObj</span><span class='hs-layout'>,</span><span class='hs-varid'>resObj</span><span class='hs-layout'>,</span><span class='hs-varid'>rolObj</span><span class='hs-layout'>)</span>
<a name="line-36"></a>		<span class='hs-varid'>groupObj</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>groupObjectsList</span> <span class='hs-varid'>info</span>
<a name="line-37"></a>		<span class='hs-layout'>(</span><span class='hs-varid'>actObj</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-varid'>partObj</span><span class='hs-layout'>,</span><span class='hs-varid'>resObj</span><span class='hs-layout'>,</span><span class='hs-varid'>rolObj</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>objects</span> <span class='hs-varid'>info</span>
<a name="line-38"></a>
<a name="line-39"></a>
<a name="line-40"></a><span class='hs-comment'>-- //////////////////////////////////// ACTIVITIES ////////////////////////////////////</span>
<a name="line-41"></a>
<a name="line-42"></a><a name="generateActivitiesLvl"></a><span class='hs-comment'>-- | 'generateActivitiesLvl', generate activities level.</span>
<a name="line-43"></a><span class='hs-definition'>generateActivitiesLvl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Level</span> <span class='hs-comment'>-- ^ Activities level.</span>
<a name="line-44"></a><span class='hs-definition'>generateActivitiesLvl</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"Activity"</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-str'>"Initial"</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-str'>"Expert"</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-str'>"Jigsaw"</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> 
<a name="line-45"></a>
<a name="line-46"></a>
<a name="line-47"></a>
<a name="line-48"></a><span class='hs-comment'>-- //////////////////////////////////// GROUPS ////////////////////////////////////</span>
<a name="line-49"></a>
<a name="line-50"></a><a name="generateGroupsLvl"></a><span class='hs-comment'>-- | 'generateGroupsLvl', generate groups level.</span>
<a name="line-51"></a><span class='hs-definition'>generateGroupsLvl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-52"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Level</span> <span class='hs-comment'>-- ^ Groups level.</span>
<a name="line-53"></a><span class='hs-definition'>generateGroupsLvl</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"Group"</span><span class='hs-layout'>,</span> <span class='hs-varid'>createGroupsInitial</span> <span class='hs-varid'>info</span> <span class='hs-conop'>:</span> <span class='hs-varid'>createGroupsExpert</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>createGroupsJigsaw</span> <span class='hs-varid'>info</span> <span class='hs-conop'>:</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>
<a name="line-54"></a>
<a name="line-55"></a>
<a name="line-56"></a>
<a name="line-57"></a><a name="createGroupsInitial"></a><span class='hs-comment'>-- | 'createGroupsInitial', create initial groups</span>
<a name="line-58"></a><span class='hs-definition'>createGroupsInitial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-59"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Group</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Initial groups.</span>
<a name="line-60"></a><span class='hs-definition'>createGroupsInitial</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-str'>"Group "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-keyglyph'>[</span><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>nbGroupsInitial</span> <span class='hs-varid'>info</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<a name="line-61"></a>
<a name="line-62"></a>
<a name="line-63"></a>
<a name="line-64"></a><a name="createGroupsExpert"></a><span class='hs-comment'>-- | 'createGroupsExpert', create expert groups.</span>
<a name="line-65"></a><span class='hs-definition'>createGroupsExpert</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-66"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Group</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Expert groups.</span>
<a name="line-67"></a><span class='hs-definition'>createGroupsExpert</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-str'>"Group Expert "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>name</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>themes</span><span class='hs-keyglyph'>]</span>
<a name="line-68"></a>
<a name="line-69"></a>
<a name="line-70"></a>
<a name="line-71"></a><a name="createGroupsJigsaw"></a><span class='hs-comment'>-- | 'createGroupsJigsaw', create jigsaw groups.</span>
<a name="line-72"></a><span class='hs-definition'>createGroupsJigsaw</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-73"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Group</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Jigsaw groups.</span>
<a name="line-74"></a><span class='hs-definition'>createGroupsJigsaw</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-str'>"Group Jigsaw "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-keyglyph'>[</span><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createParticipantsJigsaw</span> <span class='hs-layout'>(</span><span class='hs-varid'>participantsList</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<a name="line-75"></a>
<a name="line-76"></a>
<a name="line-77"></a>
<a name="line-78"></a><span class='hs-comment'>-- //////////////////////////////////// PARTICIPANTS ////////////////////////////////////</span>
<a name="line-79"></a>
<a name="line-80"></a><a name="generateParticipantsLvl"></a><span class='hs-comment'>-- | 'generateParticipantsLvl', generate participants level.</span>
<a name="line-81"></a><span class='hs-definition'>generateParticipantsLvl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-82"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Level</span> <span class='hs-comment'>-- ^ Participants level.</span>
<a name="line-83"></a><span class='hs-definition'>generateParticipantsLvl</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"Participant"</span><span class='hs-layout'>,</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>y</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>createParticipantsInitial</span> <span class='hs-varid'>info</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createParticipantsExpert</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>themes</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createParticipantsJigsaw</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>themes</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-84"></a>	<span class='hs-keyword'>where</span>
<a name="line-85"></a>		<span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>participantsList</span> <span class='hs-varid'>info</span>
<a name="line-86"></a>		<span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span>
<a name="line-87"></a>
<a name="line-88"></a>
<a name="line-89"></a>
<a name="line-90"></a><a name="createParticipantsInitial"></a><span class='hs-comment'>-- | 'createParticipantsInitial', split participants into initial groups</span>
<a name="line-91"></a><span class='hs-definition'>createParticipantsInitial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-92"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>InitialGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Initial groups.</span>
<a name="line-93"></a><span class='hs-definition'>createParticipantsInitial</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createParticipantsInitialWithTheme</span> <span class='hs-varid'>info</span>
<a name="line-94"></a>
<a name="line-95"></a>
<a name="line-96"></a>
<a name="line-97"></a>
<a name="line-98"></a><a name="createParticipantsInitialWithTheme"></a><span class='hs-comment'>-- | 'createParticipantsInitialWithTheme', split participants into initial groups.</span>
<a name="line-99"></a><span class='hs-definition'>createParticipantsInitialWithTheme</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-100"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-layout'>,</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>InitialGroup</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Initial groups with their associated theme.</span>
<a name="line-101"></a><span class='hs-definition'>createParticipantsInitialWithTheme</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>createParticipantsInitial'</span> <span class='hs-layout'>(</span><span class='hs-varid'>createParticipantsExpert</span> <span class='hs-layout'>(</span><span class='hs-varid'>participantsList</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<a name="line-102"></a>	<span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>possibleToList</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>repartitionInitial</span> <span class='hs-varid'>info</span>
<a name="line-103"></a>
<a name="line-104"></a>
<a name="line-105"></a>
<a name="line-106"></a><a name="createParticipantsInitial'"></a><span class='hs-comment'>-- | 'createParticipantsInitial'', split participants into initial groups from expert groups.</span>
<a name="line-107"></a><span class='hs-definition'>createParticipantsInitial'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>ExpertGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Expert groups.</span>
<a name="line-108"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-109"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Repartition, for each expert groups in initial groups.</span>
<a name="line-110"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-layout'>,</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>InitialGroup</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Initial groups with their associated theme.</span>
<a name="line-111"></a><span class='hs-definition'>createParticipantsInitial'</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-112"></a><span class='hs-definition'>createParticipantsInitial'</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-varid'>groups</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-varid'>themes</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>r</span><span class='hs-conop'>:</span><span class='hs-varid'>rs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span><span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>splitList</span> <span class='hs-varid'>g</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createParticipantsInitial'</span> <span class='hs-varid'>groups</span> <span class='hs-varid'>themes</span> <span class='hs-varid'>rs</span>
<a name="line-113"></a>
<a name="line-114"></a>
<a name="line-115"></a>
<a name="line-116"></a><a name="createParticipantsExpert"></a><span class='hs-comment'>-- | 'createParticipantsExpert', split participants into expert groups.</span>
<a name="line-117"></a><span class='hs-comment'>-- Merge participants splited per themes for each jigsaw group, into a list of participant splited only per themes</span>
<a name="line-118"></a><span class='hs-definition'>createParticipantsExpert</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants.</span>
<a name="line-119"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-120"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>ExpertGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Expert groups.</span>
<a name="line-121"></a><span class='hs-definition'>createParticipantsExpert</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span>
<a name="line-122"></a>	<span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>acc</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>addAll</span> <span class='hs-varid'>acc</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>replicate</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>themes</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>createParticipantsExpert'</span> <span class='hs-layout'>(</span><span class='hs-varid'>createParticipantsJigsaw</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span><span class='hs-layout'>)</span> <span class='hs-varid'>themes</span><span class='hs-layout'>)</span>
<a name="line-123"></a>
<a name="line-124"></a>
<a name="line-125"></a>
<a name="line-126"></a><a name="createParticipantsExpert'"></a><span class='hs-comment'>-- | 'createParticipantsExpert'', split jigsaw groups per themes</span>
<a name="line-127"></a><span class='hs-definition'>createParticipantsExpert'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>JigsawGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Repartition for jigsaw groups.</span>
<a name="line-128"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-129"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants splited per jigsaw groups and per themes.</span>
<a name="line-130"></a><span class='hs-definition'>createParticipantsExpert'</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-131"></a><span class='hs-definition'>createParticipantsExpert'</span> <span class='hs-layout'>(</span><span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-varid'>ps</span><span class='hs-layout'>)</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>createParticipantsExpert''</span> <span class='hs-varid'>themes</span> <span class='hs-varid'>p</span> <span class='hs-conop'>:</span> <span class='hs-varid'>createParticipantsExpert'</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>themes</span>
<a name="line-132"></a>
<a name="line-133"></a>
<a name="line-134"></a>
<a name="line-135"></a><a name="createParticipantsExpert''"></a><span class='hs-comment'>-- | 'createParticipantsExpert''', split a Jigsaw group between themes.</span>
<a name="line-136"></a><span class='hs-definition'>createParticipantsExpert''</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-137"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>JigsawGroup</span>  <span class='hs-comment'>-- ^ Participants of one jigsaw group.</span>
<a name="line-138"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants splited between themes.</span>
<a name="line-139"></a><span class='hs-definition'>createParticipantsExpert''</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-140"></a><span class='hs-definition'>createParticipantsExpert''</span> <span class='hs-varid'>themes</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitList</span> <span class='hs-varid'>ps</span> <span class='hs-varop'>$</span> <span class='hs-varid'>repart</span>
<a name="line-141"></a>	<span class='hs-keyword'>where</span>
<a name="line-142"></a>		<span class='hs-varid'>repart</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>repartition2</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span> <span class='hs-varid'>themesInfo</span> <span class='hs-keyword'>of</span>
<a name="line-143"></a>			<span class='hs-conid'>Possible</span> <span class='hs-varid'>list</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>list</span>
<a name="line-144"></a>			<span class='hs-conid'>NotPossible</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>[]</span>
<a name="line-145"></a>		<span class='hs-varid'>themesInfo</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>nbExpert</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>upperMargin</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>lowerMargin</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varid'>themes</span>
<a name="line-146"></a>
<a name="line-147"></a>
<a name="line-148"></a>
<a name="line-149"></a><a name="createParticipantsJigsaw"></a><span class='hs-comment'>-- | 'createParticipantsJigsaw', split participants into groups jigsaw.</span>
<a name="line-150"></a><span class='hs-definition'>createParticipantsJigsaw</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants.</span>
<a name="line-151"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-152"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>JigsawGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Jigsaw groups.</span>
<a name="line-153"></a><span class='hs-definition'>createParticipantsJigsaw</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitList</span> <span class='hs-varid'>participants</span> <span class='hs-varop'>$</span> <span class='hs-varid'>possibleToList</span> <span class='hs-varop'>$</span> <span class='hs-varid'>repartitionJigsaw</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span>
<a name="line-154"></a>
<a name="line-155"></a>
<a name="line-156"></a>
<a name="line-157"></a><span class='hs-comment'>-- //////////////////////////////////// RESOURCES ////////////////////////////////////</span>
<a name="line-158"></a>
<a name="line-159"></a><a name="generateResourcesLvl"></a><span class='hs-comment'>-- | 'generateResourcesLvl', generate resources level.</span>
<a name="line-160"></a><span class='hs-definition'>generateResourcesLvl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-161"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Level</span> <span class='hs-comment'>-- ^ The level resources.</span>
<a name="line-162"></a><span class='hs-definition'>generateResourcesLvl</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"Resource"</span><span class='hs-layout'>,</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>y</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>createResourcesInitial</span> <span class='hs-varid'>info</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createResourcesExpert</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>themes</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createResourcesJigsaw</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>themes</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-163"></a>	<span class='hs-keyword'>where</span>
<a name="line-164"></a>		<span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span>
<a name="line-165"></a>		<span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>participantsList</span> <span class='hs-varid'>info</span>
<a name="line-166"></a>
<a name="line-167"></a>
<a name="line-168"></a><a name="createResourcesInitial"></a><span class='hs-comment'>-- | 'createResourcesInitial', create resources list for the expert level</span>
<a name="line-169"></a><span class='hs-definition'>createResourcesInitial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-170"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Resource</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Resources.</span>
<a name="line-171"></a><span class='hs-definition'>createResourcesInitial</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>acc</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>gs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>acc</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-varid'>createResourcesInitial'</span> <span class='hs-varid'>gs</span> <span class='hs-varop'>$</span> <span class='hs-varid'>splitList2</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>resources</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>gs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varop'>$</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>resources</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-172"></a>	<span class='hs-conid'>[]</span> <span class='hs-varop'>$</span> <span class='hs-varid'>nbGroupsInitialPerThemes</span> <span class='hs-varid'>info</span>
<a name="line-173"></a>
<a name="line-174"></a>
<a name="line-175"></a>
<a name="line-176"></a><a name="createResourcesInitial'"></a><span class='hs-comment'>-- | 'createResourcesInitial'', create resources list for the initial level.</span>
<a name="line-177"></a><span class='hs-definition'>createResourcesInitial'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Number of groups for each theme.</span>
<a name="line-178"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Resource</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ List of resources for each theme.</span>
<a name="line-179"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Resource</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ List of resources duplicated for each theme by the number of initial groups for the theme.</span>
<a name="line-180"></a><span class='hs-definition'>createResourcesInitial'</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-181"></a><span class='hs-definition'>createResourcesInitial'</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>r</span><span class='hs-conop'>:</span><span class='hs-varid'>rs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>replicate</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createResourcesInitial'</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>rs</span>
<a name="line-182"></a>
<a name="line-183"></a>
<a name="line-184"></a>
<a name="line-185"></a><a name="createResourcesExpert"></a><span class='hs-comment'>-- | 'createResourcesExpert', create resources list for the expert level</span>
<a name="line-186"></a><span class='hs-definition'>createResourcesExpert</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants.</span>
<a name="line-187"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-188"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Resource</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Resources.</span>
<a name="line-189"></a><span class='hs-definition'>createResourcesExpert</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>createResourcesExpert'</span> <span class='hs-varid'>themes</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createParticipantsExpert</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span>
<a name="line-190"></a>
<a name="line-191"></a>
<a name="line-192"></a>
<a name="line-193"></a><a name="createResourcesExpert'"></a><span class='hs-comment'>-- | 'createResourcesExpert'', create resources for the expert level.</span>
<a name="line-194"></a><span class='hs-definition'>createResourcesExpert'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-195"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>ExpertGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Expert groups.</span>
<a name="line-196"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Resource</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Resources.</span>
<a name="line-197"></a><span class='hs-definition'>createResourcesExpert'</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-198"></a><span class='hs-definition'>createResourcesExpert'</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-varid'>themes</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-varid'>groups</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>resourcesTheme</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createResourcesExpert'</span> <span class='hs-varid'>themes</span> <span class='hs-varid'>groups</span>
<a name="line-199"></a>	<span class='hs-keyword'>where</span>
<a name="line-200"></a>		<span class='hs-varid'>resourcesTheme</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>resources</span> <span class='hs-varid'>t</span>
<a name="line-201"></a>
<a name="line-202"></a>
<a name="line-203"></a>
<a name="line-204"></a><a name="createResourcesJigsaw"></a><span class='hs-comment'>-- | 'createResourcesJigsaw', create resources list for the jigsaw level</span>
<a name="line-205"></a><span class='hs-definition'>createResourcesJigsaw</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants.</span>
<a name="line-206"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-207"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Resource</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Resources for the jigsaw level.</span>
<a name="line-208"></a><span class='hs-definition'>createResourcesJigsaw</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>replicate</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>participants</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>allResources</span> <span class='hs-varid'>themes</span>
<a name="line-209"></a>
<a name="line-210"></a>
<a name="line-211"></a>
<a name="line-212"></a><span class='hs-comment'>-- //////////////////////////////////// UTIL ////////////////////////////////////</span>
<a name="line-213"></a>
<a name="line-214"></a><a name="repartitionInitial"></a><span class='hs-comment'>-- | 'repartitionInitial', repartition for initial groups.</span>
<a name="line-215"></a><span class='hs-definition'>repartitionInitial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-216"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Possible</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Possible repartition.</span>
<a name="line-217"></a><span class='hs-definition'>repartitionInitial</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>repartitionInitial'</span> <span class='hs-layout'>(</span><span class='hs-varid'>createParticipantsExpert</span> <span class='hs-layout'>(</span><span class='hs-varid'>participantsList</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>nbPPG</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>above</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>below</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span>
<a name="line-218"></a>
<a name="line-219"></a>
<a name="line-220"></a>
<a name="line-221"></a><a name="repartitionInitial'"></a><span class='hs-comment'>-- | 'repartitionInitial'', list of size for jigsaw's group.</span>
<a name="line-222"></a><span class='hs-definition'>repartitionInitial'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>ExpertGroup</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Expert groups.</span>
<a name="line-223"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-224"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-comment'>-- ^ Number of participants per groups.</span>
<a name="line-225"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-comment'>-- ^ Above margin.</span>
<a name="line-226"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-comment'>-- ^ Below margin.</span>
<a name="line-227"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Possible</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ List of size for jigsaw's group.</span>
<a name="line-228"></a><span class='hs-definition'>repartitionInitial'</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-229"></a><span class='hs-definition'>repartitionInitial'</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-varid'>groups</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-varid'>themes</span><span class='hs-layout'>)</span> <span class='hs-varid'>nbPPG</span> <span class='hs-varid'>above</span> <span class='hs-varid'>below</span> <span class='hs-keyglyph'>=</span>
<a name="line-230"></a>	<span class='hs-keyword'>case</span> <span class='hs-varid'>repartition</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>nbPPG</span> <span class='hs-varid'>above</span> <span class='hs-varid'>below</span> <span class='hs-conid'>True</span> <span class='hs-keyword'>of</span>
<a name="line-231"></a>		<span class='hs-conid'>NotPossible</span> <span class='hs-varid'>msg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NotPossible</span> <span class='hs-layout'>(</span><span class='hs-str'>"Can't do a good repartition for initial group on the theme "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>name</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>repartitionInitial'</span> <span class='hs-varid'>groups</span> <span class='hs-varid'>themes</span> <span class='hs-varid'>nbPPG</span> <span class='hs-varid'>above</span> <span class='hs-varid'>below</span>
<a name="line-232"></a>		<span class='hs-conid'>Possible</span> <span class='hs-varid'>list</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Possible</span> <span class='hs-varid'>list</span> <span class='hs-conop'>:</span> <span class='hs-varid'>repartitionInitial'</span> <span class='hs-varid'>groups</span> <span class='hs-varid'>themes</span> <span class='hs-varid'>nbPPG</span> <span class='hs-varid'>above</span> <span class='hs-varid'>below</span>
<a name="line-233"></a>
<a name="line-234"></a>
<a name="line-235"></a>
<a name="line-236"></a><a name="repartitionJigsaw"></a><span class='hs-comment'>-- | 'repartitionJigsaw', list of size for jigsaw's group.</span>
<a name="line-237"></a><span class='hs-definition'>repartitionJigsaw</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants.</span>
<a name="line-238"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-239"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Possible</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Possible repartition.</span>
<a name="line-240"></a><span class='hs-definition'>repartitionJigsaw</span> <span class='hs-varid'>participants</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span>
<a name="line-241"></a>	<span class='hs-keyword'>case</span> <span class='hs-varid'>repartition</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>participants</span><span class='hs-layout'>)</span> <span class='hs-varid'>nbPPGJ</span> <span class='hs-varid'>upperMarginJigsaw</span> <span class='hs-varid'>lowerMarginJigsaw</span> <span class='hs-conid'>True</span> <span class='hs-keyword'>of</span>
<a name="line-242"></a>		<span class='hs-conid'>NotPossible</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NotPossible</span> <span class='hs-str'>"Can't do a good repartition for jigsaw groups"</span>
<a name="line-243"></a>		<span class='hs-conid'>Possible</span> <span class='hs-varid'>list</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Possible</span> <span class='hs-varid'>list</span>
<a name="line-244"></a>	<span class='hs-keyword'>where</span>
<a name="line-245"></a>		<span class='hs-layout'>(</span><span class='hs-varid'>nbPPGJ</span><span class='hs-layout'>,</span> <span class='hs-varid'>upperMarginJigsaw</span><span class='hs-layout'>,</span> <span class='hs-varid'>lowerMarginJigsaw</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nbParticipantJigsaw</span> <span class='hs-varid'>themes</span>
<a name="line-246"></a>
<a name="line-247"></a>
<a name="line-248"></a>
<a name="line-249"></a><a name="allResources"></a><span class='hs-comment'>-- | 'allResources', create a list with all the resources.</span>
<a name="line-250"></a><span class='hs-definition'>allResources</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-251"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span>	<span class='hs-comment'>-- ^ All resources.</span>
<a name="line-252"></a><span class='hs-definition'>allResources</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>acc</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>acc</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>resources</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>themes</span>
<a name="line-253"></a>
<a name="line-254"></a>
<a name="line-255"></a>
<a name="line-256"></a><a name="nbParticipantJigsaw"></a><span class='hs-comment'>-- | 'nbParticipantJigsaw', give information on the repartition wanted for jigsaw groups.</span>
<a name="line-257"></a><span class='hs-definition'>nbParticipantJigsaw</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Themes.</span>
<a name="line-258"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- ^ (number of participants wanted for a jigsaw group, how many participants additional are tolerated, how many participants less are tolerated)</span>
<a name="line-259"></a><span class='hs-definition'>nbParticipantJigsaw</span> <span class='hs-varid'>themes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>,</span><span class='hs-varid'>z</span><span class='hs-layout'>)</span> <span class='hs-varid'>theme</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>nbExpert</span> <span class='hs-varid'>theme</span><span class='hs-layout'>,</span> <span class='hs-varid'>y</span> <span class='hs-varop'>+</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>upperMargin</span> <span class='hs-varid'>theme</span><span class='hs-layout'>,</span> <span class='hs-varid'>z</span> <span class='hs-varop'>+</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>lowerMargin</span> <span class='hs-varid'>theme</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>themes</span>
<a name="line-260"></a>
<a name="line-261"></a>
<a name="line-262"></a>
<a name="line-263"></a><a name="nbGroupsInitial"></a><span class='hs-comment'>-- | 'nbGroupInitial', number of initial groups.</span>
<a name="line-264"></a><span class='hs-definition'>nbGroupsInitial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern info.</span>
<a name="line-265"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-comment'>-- ^  Number of initial groups.</span>
<a name="line-266"></a><span class='hs-definition'>nbGroupsInitial</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>length</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createParticipantsInitial</span> <span class='hs-varid'>info</span>
<a name="line-267"></a>
<a name="line-268"></a>
<a name="line-269"></a>
<a name="line-270"></a><a name="nbGroupsInitialPerThemes"></a><span class='hs-comment'>-- | 'nbGroupsInitialPerThemes', number of initial group per themes.</span>
<a name="line-271"></a><span class='hs-definition'>nbGroupsInitialPerThemes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern info.</span>
<a name="line-272"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Theme</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ (theme, length of groups of the theme)</span>
<a name="line-273"></a><span class='hs-definition'>nbGroupsInitialPerThemes</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>acc</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>acc</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldl</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>acc2</span> <span class='hs-layout'>(</span><span class='hs-varid'>t2</span><span class='hs-layout'>,</span><span class='hs-varid'>ps</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> 
<a name="line-274"></a>	<span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>name</span> <span class='hs-varid'>t2</span> <span class='hs-varop'>==</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>name</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>acc2</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>length</span> <span class='hs-varid'>ps</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>acc2</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createParticipantsInitialWithTheme</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span>
<a name="line-275"></a>
<a name="line-276"></a>
<a name="line-277"></a>
<a name="line-278"></a><a name="participantsList"></a><span class='hs-comment'>-- | 'participantsList', list of participants logins</span>
<a name="line-279"></a><span class='hs-definition'>participantsList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-280"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Participant</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Participants.</span>
<a name="line-281"></a><span class='hs-definition'>participantsList</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>participantsLogins</span> <span class='hs-varop'>$</span> <span class='hs-varid'>participantsObjects</span> <span class='hs-varop'>$</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>objects</span> <span class='hs-varid'>info</span>
<a name="line-282"></a>
<a name="line-283"></a>
<a name="line-284"></a>
<a name="line-285"></a><a name="groupObjectsList"></a><span class='hs-comment'>-- | 'groupObjectsList', create the group objects list for .t2</span>
<a name="line-286"></a><span class='hs-definition'>groupObjectsList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Info</span> <span class='hs-comment'>-- ^ Pattern information.</span>
<a name="line-287"></a>	<span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GroupObjects</span> <span class='hs-comment'>-- ^ Groups objects for .t2.</span>
<a name="line-288"></a><span class='hs-definition'>groupObjectsList</span> <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>groupsInitial</span> <span class='hs-varop'>++</span> <span class='hs-varid'>groupsExpertJigsaw</span>
<a name="line-289"></a>	<span class='hs-keyword'>where</span>
<a name="line-290"></a>		<span class='hs-varid'>groupsInitial</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-varid'>n</span> <span class='hs-varop'>++</span> <span class='hs-str'>" sur le thème "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>name</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>zip</span> <span class='hs-layout'>(</span><span class='hs-varid'>concat</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createGroupsInitial</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createParticipantsInitialWithTheme</span> <span class='hs-varid'>info</span>
<a name="line-291"></a>		<span class='hs-varid'>groupsExpertJigsaw</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-layout'>,</span><span class='hs-varid'>g</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concat</span> <span class='hs-layout'>(</span><span class='hs-varid'>createGroupsExpert</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>themes</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span> <span class='hs-varid'>createGroupsJigsaw</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span>
</pre></body>
</html>
